# Device Registration Flow Test
# Tests initial device registration on first app launch

appId: three.two.bit.phonemanager.dev
name: Device Registration Flow

---
# Launch the app with clearState and permissions
- launchApp:
    appId: "three.two.bit.phonemanager.dev"
    clearState: true
    stopApp: true
    permissions:
      all: allow

# Wait for app to load
- waitForAnimationToEnd

# Take screenshot to see initial state
- takeScreenshot: "initial_launch"

# Wait for registration screen to appear
- extendedWaitUntil:
    visible:
      text: "Device Registration"
    timeout: 30000

# Take screenshot of registration screen
- takeScreenshot: "registration_screen"

# Enter display name
- tapOn:
    text: "Display Name"

- inputText: "TestDevice"

- hideKeyboard

# Enter group ID
- tapOn:
    text: "Group ID"

- inputText: "test-group"

- hideKeyboard

# Submit registration
- tapOn:
    text: "Register"

# Wait for home screen (successful registration)
- extendedWaitUntil:
    visible:
      text: "Location Tracking"
    timeout: 30000

# Take screenshot of successful registration
- takeScreenshot: "registration_success"
