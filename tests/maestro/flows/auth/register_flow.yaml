# Registration Flow Test
# Tests new user registration

appId: three.two.bit.phonemanager.dev
name: User Registration Flow

---
# Clear app state
- clearState

# Launch the app
- launchApp

# Wait for login screen
- extendedWaitUntil:
    visible:
      id: "login_screen"
    timeout: 10000

# Wait for email input
- extendedWaitUntil:
    visible:
      id: "email_input"
    timeout: 5000

# Navigate to registration
- tapOn:
    id: "create_account_link"

# Wait for registration screen
- extendedWaitUntil:
    visible:
      id: "register_screen"
    timeout: 5000

# Verify registration form elements
- assertVisible:
    id: "display_name_input"

- assertVisible:
    id: "register_email_input"

- assertVisible:
    id: "register_password_input"

- assertVisible:
    id: "confirm_password_input"

- assertVisible:
    id: "create_account_button"

# Enter name
- tapOn:
    id: "display_name_input"

- inputText: "New Test User"

# Enter email (using timestamp to ensure uniqueness)
- tapOn:
    id: "register_email_input"

- inputText: "newuser_${timestamp}@example.com"

# Enter password
- tapOn:
    id: "register_password_input"

- inputText: "NewUser123!"

# Confirm password
- tapOn:
    id: "confirm_password_input"

- inputText: "NewUser123!"

# Note: Terms of service checkbox is required - need to tap it
# This test assumes registration may fail since TOS is required

# Submit registration (may fail without TOS acceptance)
- tapOn:
    id: "create_account_button"

# Wait for home screen (successful registration auto-logs in)
- extendedWaitUntil:
    visible:
      id: "home_screen"
    timeout: 15000

# Take screenshot of successful registration
- takeScreenshot: "registration_success"
