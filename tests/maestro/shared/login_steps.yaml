# Shared App Setup Steps
# Reusable app setup flow that can be included in other tests
# Note: The app shows a device registration screen on first launch

appId: three.two.bit.phonemanager.dev
name: Shared Login Steps

---
# Launch the app with clearState and permissions
# Using explicit launchApp syntax for CI compatibility
- launchApp:
    appId: "three.two.bit.phonemanager.dev"
    clearState: true
    stopApp: true
    permissions:
      all: allow

# Give app time to initialize
- waitForAnimationToEnd

# Wait for registration screen to appear (using text)
- extendedWaitUntil:
    visible:
      text: "Device Registration"
    timeout: 30000

# Take screenshot of registration screen
- takeScreenshot: "registration_screen_visible"

# Enter display name - tap on field
- tapOn:
    text: "Display Name"

- inputText: "TestDevice"

- hideKeyboard

# Enter group ID - tap on field
- tapOn:
    text: "Group ID"

- inputText: "test-group"

- hideKeyboard

# Tap Register button
- tapOn:
    text: "Register"

# Wait for home screen after registration
- extendedWaitUntil:
    visible:
      text: "Location Tracking"
    timeout: 30000

# Take screenshot of successful registration
- takeScreenshot: "registration_complete"
